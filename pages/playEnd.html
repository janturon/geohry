<script>
    //potrebuji nejake takove pole se vsemi opovedmi, struktura muze byt jina, ale tohle mi prijde celkem dobré

    /*const STATE = {
        allAnswers: [{
            questionName: "o1",
            score: 1
        }, {
            questionName: "o2",
            score: 2
        }, {
            questionName: "o3",
            score: 2
        }, {
            questionName: "o4",
            score: 1
        }]
    };*/

    /*STATE.answers = {
        "asdfoo": 5,
        "oěuasjdf": 7
    };*/
    
    const answers = STATE.answers;
    const data = [];

    for(const key in answers) {

        const q = questions.find(i => i.uniqid === key);
        data.push({
            questionName: q.name, score: answers[key]
        });

    }

    /*const data = [{
            questionName: "o1",
            score: 1
        }, {
            questionName: "o2",
            score: 2
        }, {
            questionName: "o3",
            score: 2
        }, {
            questionName: "o4",
            score: 1
        }];*/

    const maxScore = data.length * 2;
    const sumScore = data.reduce((acc, val) => acc + val.score, 0);
    const sortedByScore = data.sort((a, b) => b.score - a.score);

    const dataTemp = [];

    sortedByScore.forEach((piece, i, a) => {

        if(i === 0) {
            dataTemp.push([
                piece.questionName, piece.score, `${ sumScore }/${ maxScore }`
            ]);
        } else {
            dataTemp.push([
                piece.questionName, piece.score
            ]);
        }
       

    });

    const tableTemp = {
        headers: ["Otázka", "Počet bodů", "Celkem bodů"],
        rowSpan: [1, 1, data.length],
        colSpan: [1, 1, 1],
        data: [
            ...dataTemp
        ]
    };


    async function sendScore() {
        await API("sendScore", JSON.stringify(answers));
        //setContent("homeGame");
    }
</script>

<h2>Tvoje skóre</h2>

<div id="resultTable" style="margin-bottom: 20px;"></div>
<script>
    id("resultTable");
    resultTable.appendChild(
        createScoreTable(tableTemp)
    );
</script>

<div id="goodbyeMessage" style="margin-bottom: 20px;"></div>
<script>
    id("goodbyeMessage");
    goodbyeMessage.innerText = game.goodbye;
</script>

<button type="button" onclick="sendScore()">Ok</button>